<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: fig1 Pages: 1 -->
<svg width="1177pt" height="392pt"
 viewBox="0.00 0.00 1176.89 392.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 388)">
<title>fig1</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-388 1172.89,-388 1172.89,4 -4,4"/>
<!-- SEND_RECV -->
<g id="node1" class="node"><title>SEND_RECV</title>
<ellipse fill="none" stroke="black" cx="670" cy="-366" rx="63.8893" ry="18"/>
<text text-anchor="middle" x="670" y="-362.3" font-family="Times New Roman,serif" font-size="14.00">SEND_RECV</text>
</g>
<!-- SEND_RECV&#45;&gt;SEND_RECV -->
<g id="edge1" class="edge"><title>SEND_RECV&#45;&gt;SEND_RECV</title>
<path fill="none" stroke="black" d="M727.636,-373.736C741.455,-373.131 751.694,-370.553 751.694,-366 751.694,-362.657 746.172,-360.378 737.766,-359.164"/>
<polygon fill="black" stroke="black" points="737.907,-355.662 727.636,-358.264 737.287,-362.635 737.907,-355.662"/>
<text text-anchor="middle" x="813.694" y="-362.3" font-family="Times New Roman,serif" font-size="14.00">未发送完成或未收到包头</text>
</g>
<!-- L2_FILTER -->
<g id="node2" class="node"><title>L2_FILTER</title>
<ellipse fill="none" stroke="black" cx="390" cy="-279" rx="56.59" ry="18"/>
<text text-anchor="middle" x="390" y="-275.3" font-family="Times New Roman,serif" font-size="14.00">L2_FILTER</text>
</g>
<!-- SEND_RECV&#45;&gt;L2_FILTER -->
<g id="edge2" class="edge"><title>SEND_RECV&#45;&gt;L2_FILTER</title>
<path fill="none" stroke="black" d="M622.891,-353.749C596.842,-347.287 563.977,-338.738 535,-330 501.248,-319.822 463.626,-306.799 435.164,-296.596"/>
<polygon fill="black" stroke="black" points="436.094,-293.211 425.5,-293.113 433.721,-299.796 436.094,-293.211"/>
<text text-anchor="middle" x="558" y="-318.8" font-family="Times New Roman,serif" font-size="14.00">收到包头</text>
</g>
<!-- DROP -->
<g id="node3" class="node"><title>DROP</title>
<ellipse fill="none" stroke="black" cx="311" cy="-18" rx="35.9954" ry="18"/>
<text text-anchor="middle" x="311" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">DROP</text>
</g>
<!-- L2_FILTER&#45;&gt;DROP -->
<g id="edge3" class="edge"><title>L2_FILTER&#45;&gt;DROP</title>
<path fill="none" stroke="black" d="M335.167,-274.539C262.257,-266.648 135.88,-240.78 78,-156 26.6825,-80.8323 186.869,-40.9245 267.531,-25.9954"/>
<polygon fill="black" stroke="black" points="268.199,-29.4314 277.422,-24.2161 266.96,-22.542 268.199,-29.4314"/>
<text text-anchor="middle" x="176" y="-144.8" font-family="Times New Roman,serif" font-size="14.00">目标MAC地址非本机或ethertype非法</text>
</g>
<!-- ARP_RECV -->
<g id="node4" class="node"><title>ARP_RECV</title>
<ellipse fill="none" stroke="black" cx="295" cy="-192" rx="57.6901" ry="18"/>
<text text-anchor="middle" x="295" y="-188.3" font-family="Times New Roman,serif" font-size="14.00">ARP_RECV</text>
</g>
<!-- L2_FILTER&#45;&gt;ARP_RECV -->
<g id="edge4" class="edge"><title>L2_FILTER&#45;&gt;ARP_RECV</title>
<path fill="none" stroke="black" d="M371.683,-261.611C357.226,-248.676 336.881,-230.473 320.78,-216.066"/>
<polygon fill="black" stroke="black" points="323.047,-213.398 313.261,-209.339 318.379,-218.615 323.047,-213.398"/>
<text text-anchor="middle" x="369" y="-231.8" font-family="Times New Roman,serif" font-size="14.00">ARP包</text>
</g>
<!-- IP4_QUERY_FT -->
<g id="node5" class="node"><title>IP4_QUERY_FT</title>
<ellipse fill="none" stroke="black" cx="595" cy="-192" rx="75.2868" ry="18"/>
<text text-anchor="middle" x="595" y="-188.3" font-family="Times New Roman,serif" font-size="14.00">IP4_QUERY_FT</text>
</g>
<!-- L2_FILTER&#45;&gt;IP4_QUERY_FT -->
<g id="edge5" class="edge"><title>L2_FILTER&#45;&gt;IP4_QUERY_FT</title>
<path fill="none" stroke="black" d="M422.937,-264.343C457.264,-250.11 511.301,-227.705 549.65,-211.804"/>
<polygon fill="black" stroke="black" points="551.144,-214.973 559.041,-207.91 548.463,-208.507 551.144,-214.973"/>
<text text-anchor="middle" x="524" y="-231.8" font-family="Times New Roman,serif" font-size="14.00">IPv4包</text>
</g>
<!-- DROP&#45;&gt;SEND_RECV -->
<g id="edge19" class="edge"><title>DROP&#45;&gt;SEND_RECV</title>
<path fill="none" stroke="black" d="M275.627,-21.182C194.114,-27.1774 0,-47.3969 0,-104 0,-280 0,-280 0,-280 0,-339.6 422.644,-358.146 596.574,-363.255"/>
<polygon fill="black" stroke="black" points="596.57,-366.756 606.666,-363.544 596.771,-359.759 596.57,-366.756"/>
<text text-anchor="middle" x="11.5" y="-188.3" font-family="Times New Roman,serif" font-size="14.00">丢弃</text>
</g>
<!-- ARP_RECV&#45;&gt;DROP -->
<g id="edge6" class="edge"><title>ARP_RECV&#45;&gt;DROP</title>
<path fill="none" stroke="black" d="M287.521,-173.942C279.443,-153.237 268.654,-117.325 276,-87 279.662,-71.8838 287.301,-56.3635 294.511,-43.974"/>
<polygon fill="black" stroke="black" points="297.66,-45.5309 299.867,-35.1685 291.68,-41.8929 297.66,-45.5309"/>
<text text-anchor="middle" x="307" y="-101.3" font-family="Times New Roman,serif" font-size="14.00">非法ARP包</text>
</g>
<!-- ARP_UPDATE -->
<g id="node6" class="node"><title>ARP_UPDATE</title>
<ellipse fill="none" stroke="black" cx="494" cy="-105" rx="69.5877" ry="18"/>
<text text-anchor="middle" x="494" y="-101.3" font-family="Times New Roman,serif" font-size="14.00">ARP_UPDATE</text>
</g>
<!-- ARP_RECV&#45;&gt;ARP_UPDATE -->
<g id="edge7" class="edge"><title>ARP_RECV&#45;&gt;ARP_UPDATE</title>
<path fill="none" stroke="black" d="M327.861,-176.964C361.201,-162.723 413.016,-140.591 449.909,-124.833"/>
<polygon fill="black" stroke="black" points="451.597,-127.918 459.419,-120.771 448.847,-121.48 451.597,-127.918"/>
<text text-anchor="middle" x="438" y="-144.8" font-family="Times New Roman,serif" font-size="14.00">合法ARP包</text>
</g>
<!-- IP4_QUERY_FT&#45;&gt;SEND_RECV -->
<g id="edge11" class="edge"><title>IP4_QUERY_FT&#45;&gt;SEND_RECV</title>
<path fill="none" stroke="black" d="M594.291,-210.054C594.061,-231.382 595.866,-268.55 609,-297 616.817,-313.933 630.324,-329.657 642.643,-341.711"/>
<polygon fill="black" stroke="black" points="640.416,-344.421 650.099,-348.72 645.21,-339.321 640.416,-344.421"/>
<text text-anchor="middle" x="670" y="-275.3" font-family="Times New Roman,serif" font-size="14.00">是发送给CPU的IPv4包</text>
</g>
<!-- IP4_QUERY_FT&#45;&gt;DROP -->
<g id="edge12" class="edge"><title>IP4_QUERY_FT&#45;&gt;DROP</title>
<path fill="none" stroke="black" d="M526.928,-184.161C478.466,-176.272 414.185,-159.328 369,-123 344.158,-103.027 328.201,-69.3879 319.437,-45.789"/>
<polygon fill="black" stroke="black" points="322.632,-44.3225 316.014,-36.0488 316.028,-46.6437 322.632,-44.3225"/>
<text text-anchor="middle" x="392" y="-101.3" font-family="Times New Roman,serif" font-size="14.00">没有路由</text>
</g>
<!-- IP4_QUERY_FT&#45;&gt;DROP -->
<g id="edge13" class="edge"><title>IP4_QUERY_FT&#45;&gt;DROP</title>
<path fill="none" stroke="black" d="M596.136,-173.687C596.658,-151.05 594.14,-111.416 573,-87 557.814,-69.4602 545.464,-77.8064 524,-69 509.095,-62.8848 506.346,-58.9046 491,-54 445.819,-39.5604 392.258,-30.0731 355.376,-24.6647"/>
<polygon fill="black" stroke="black" points="355.83,-21.1942 345.436,-23.2467 354.842,-28.124 355.83,-21.1942"/>
<text text-anchor="middle" x="615.5" y="-101.3" font-family="Times New Roman,serif" font-size="14.00">TTL超时</text>
</g>
<!-- IP4_QUERY_ARP -->
<g id="node8" class="node"><title>IP4_QUERY_ARP</title>
<ellipse fill="none" stroke="black" cx="750" cy="-105" rx="82.5854" ry="18"/>
<text text-anchor="middle" x="750" y="-101.3" font-family="Times New Roman,serif" font-size="14.00">IP4_QUERY_ARP</text>
</g>
<!-- IP4_QUERY_FT&#45;&gt;IP4_QUERY_ARP -->
<g id="edge14" class="edge"><title>IP4_QUERY_FT&#45;&gt;IP4_QUERY_ARP</title>
<path fill="none" stroke="black" d="M623.791,-175.211C648.647,-161.581 684.743,-141.786 711.972,-126.854"/>
<polygon fill="black" stroke="black" points="713.752,-129.87 720.837,-121.993 710.386,-123.732 713.752,-129.87"/>
<text text-anchor="middle" x="735" y="-144.8" font-family="Times New Roman,serif" font-size="14.00">是需要转发的IPv4包</text>
</g>
<!-- ARP_UPDATE&#45;&gt;DROP -->
<g id="edge9" class="edge"><title>ARP_UPDATE&#45;&gt;DROP</title>
<path fill="none" stroke="black" d="M461.705,-88.9994C429.205,-73.9039 379.242,-50.6969 345.859,-35.1913"/>
<polygon fill="black" stroke="black" points="347.034,-31.8782 336.49,-30.8398 344.085,-38.2268 347.034,-31.8782"/>
<text text-anchor="middle" x="450.5" y="-57.8" font-family="Times New Roman,serif" font-size="14.00">是其他ARP包</text>
</g>
<!-- ARP_SEND_ARP_REPLY -->
<g id="node7" class="node"><title>ARP_SEND_ARP_REPLY</title>
<ellipse fill="none" stroke="black" cx="552" cy="-18" rx="113.98" ry="18"/>
<text text-anchor="middle" x="552" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">ARP_SEND_ARP_REPLY</text>
</g>
<!-- ARP_UPDATE&#45;&gt;ARP_SEND_ARP_REPLY -->
<g id="edge8" class="edge"><title>ARP_UPDATE&#45;&gt;ARP_SEND_ARP_REPLY</title>
<path fill="none" stroke="black" d="M505.459,-87.2067C513.746,-75.0621 525.094,-58.4315 534.51,-44.6326"/>
<polygon fill="black" stroke="black" points="537.621,-46.2823 540.366,-36.0493 531.839,-42.3368 537.621,-46.2823"/>
<text text-anchor="middle" x="592" y="-57.8" font-family="Times New Roman,serif" font-size="14.00">是发给本机的ARP请求包</text>
</g>
<!-- ARP_SEND_ARP_REPLY&#45;&gt;SEND_RECV -->
<g id="edge10" class="edge"><title>ARP_SEND_ARP_REPLY&#45;&gt;SEND_RECV</title>
<path fill="none" stroke="black" d="M642.471,-29.0133C664.251,-31.3639 687.451,-33.8181 709,-36 751.416,-40.2948 867.28,-26.6701 900,-54 917.711,-68.7936 914,-80.9231 914,-104 914,-280 914,-280 914,-280 914,-317.916 807.602,-342.821 735.325,-355.366"/>
<polygon fill="black" stroke="black" points="734.642,-351.932 725.367,-357.054 735.812,-358.833 734.642,-351.932"/>
<text text-anchor="middle" x="967.5" y="-188.3" font-family="Times New Roman,serif" font-size="14.00">开始发送ARP响应包</text>
</g>
<!-- IP4_REASSEMBLE -->
<g id="node9" class="node"><title>IP4_REASSEMBLE</title>
<ellipse fill="none" stroke="black" cx="805" cy="-18" rx="87.1846" ry="18"/>
<text text-anchor="middle" x="805" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">IP4_REASSEMBLE</text>
</g>
<!-- IP4_QUERY_ARP&#45;&gt;IP4_REASSEMBLE -->
<g id="edge15" class="edge"><title>IP4_QUERY_ARP&#45;&gt;IP4_REASSEMBLE</title>
<path fill="none" stroke="black" d="M715.627,-88.387C700.319,-79.205 687.627,-66.8911 697,-54 703.903,-44.5062 713.439,-37.5354 724.01,-32.4276"/>
<polygon fill="black" stroke="black" points="725.679,-35.5217 733.525,-28.4018 722.952,-29.0749 725.679,-35.5217"/>
<text text-anchor="middle" x="733.5" y="-57.8" font-family="Times New Roman,serif" font-size="14.00">ARP缓存有效</text>
</g>
<!-- IP4_SEND_ARP_REQUEST -->
<g id="node10" class="node"><title>IP4_SEND_ARP_REQUEST</title>
<ellipse fill="none" stroke="black" cx="1048" cy="-18" rx="120.779" ry="18"/>
<text text-anchor="middle" x="1048" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">IP4_SEND_ARP_REQUEST</text>
</g>
<!-- IP4_QUERY_ARP&#45;&gt;IP4_SEND_ARP_REQUEST -->
<g id="edge16" class="edge"><title>IP4_QUERY_ARP&#45;&gt;IP4_SEND_ARP_REQUEST</title>
<path fill="none" stroke="black" d="M798.21,-90.2488C849.025,-75.7546 929.283,-52.8623 985.059,-36.953"/>
<polygon fill="black" stroke="black" points="986.173,-40.275 994.829,-34.1662 984.252,-33.5435 986.173,-40.275"/>
<text text-anchor="middle" x="953.5" y="-57.8" font-family="Times New Roman,serif" font-size="14.00">ARP缓存缺失</text>
</g>
<!-- IP4_REASSEMBLE&#45;&gt;SEND_RECV -->
<g id="edge17" class="edge"><title>IP4_REASSEMBLE&#45;&gt;SEND_RECV</title>
<path fill="none" stroke="black" d="M845.226,-34.0875C853.506,-39.1248 861.166,-45.6531 866,-54 869.341,-59.769 867.384,-62.4786 866,-69 860.548,-94.6915 858.976,-102.96 842,-123 824.79,-143.316 814.819,-142.28 792,-156 777.682,-164.609 769.079,-160.676 759,-174 725.176,-218.713 756.766,-247.206 731,-297 722.369,-313.68 708.67,-329.48 696.439,-341.643"/>
<polygon fill="black" stroke="black" points="693.857,-339.27 689.071,-348.723 698.707,-344.318 693.857,-339.27"/>
<text text-anchor="middle" x="825.5" y="-195.8" font-family="Times New Roman,serif" font-size="14.00">修改目标接口和MAC地址</text>
<text text-anchor="middle" x="825.5" y="-180.8" font-family="Times New Roman,serif" font-size="14.00">开始发送IPv4包</text>
</g>
<!-- IP4_SEND_ARP_REQUEST&#45;&gt;SEND_RECV -->
<g id="edge18" class="edge"><title>IP4_SEND_ARP_REQUEST&#45;&gt;SEND_RECV</title>
<path fill="none" stroke="black" d="M1050.9,-36.1999C1053.53,-53.3303 1057,-80.4053 1057,-104 1057,-280 1057,-280 1057,-280 1057,-343.455 856.008,-359.596 743.72,-363.662"/>
<polygon fill="black" stroke="black" points="743.348,-360.172 733.472,-364.008 743.584,-367.168 743.348,-360.172"/>
<text text-anchor="middle" x="1110.5" y="-188.3" font-family="Times New Roman,serif" font-size="14.00">开始发送ARP请求包</text>
</g>
</g>
</svg>
