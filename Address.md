Thinpad 工程
---------------

### Wishbone 总线地址设定

#### 时钟中断

|    地址    |                     说明                     |
| :--------: | :------------------------------------------: |
| 0x0200BFF8 |      mtime，64位，可读写。表示当前时间       |
| 0x02004000 | mtimecmp，64位，可读写。表示下次时钟中断时间 |

#### UART 串口

|    地址    |  位   |                        说明                        |
| :--------: | :---: | :------------------------------------------------: |
| 0x10000000 | [7:0] | 串口数据，读、写地址分别表示串口接收、发送一个字节 |
| 0x10000005 |  [5]  |        只读，为1时表示串口空闲，可发送数据         |
| 0x10000005 |  [0]  |            只读，为1时表示串口收到数据             |

#### GPIO

|       地址区间        |                    说明                    |
| :-------------------: | :----------------------------------------: |
| 0x20000000-0x20000003 |            32位拨码开关（只读）            |
| 0x20000004-0x20000005 |              16位leds（读写）              |
| 0x20000008-0x20000008 | 4位touch_btn（在第一个字节的低四位，只读） |
| 0x2000000c-0x2000000d |           8位dpy0和dpy1（读写）            |

#### BRAM——VGA图片存储（已禁用）

|       地址区间        | 说明  | 存储单元数据位宽 | 对齐后数据位宽 | 存储单元地址数量 | 存储单元地址位宽 | BRAM 数量 |
| :-------------------: | :---: | :--------------: | :------------: | :--------------: | :--------------: | :-------: |
| 0x30000000-0x30FFFFFF | BRAM1 |        32        |       32       |      480000      |        19        |   107.5   |

#### BRAM——转发表内部节点

|       地址区间        | 说明  | 存储单元数据位宽 | 对齐后数据位宽 | 存储单元地址数量 | 存储单元地址位宽 | BRAM 数量 | IP 地址前缀 |
| :-------------------: | :---: | :--------------: | :------------: | :--------------: | :--------------: | :-------: | :---------: |
| 0x40000000-0x40FFFFFF | BRAM1 |        72        |      128       |       1024       |        10        |     2     |    0-15     |
| 0x41000000-0x41FFFFFF | BRAM2 |        72        |      128       |       1024       |        10        |     2     |    16-31    |
| 0x42000000-0x42FFFFFF | BRAM3 |        72        |      128       |       1024       |        10        |     2     |    32-47    |
| 0x43000000-0x43FFFFFF | BRAM4 |        72        |      128       |       1024       |        10        |     2     |    48-63    |
| 0x44000000-0x44FFFFFF | BRAM5 |        72        |      128       |       1024       |        10        |     2     |    64-79    |
| 0x45000000-0x45FFFFFF | BRAM6 |        72        |      128       |       1024       |        10        |     2     |    80-95    |
| 0x46000000-0x46FFFFFF | BRAM7 |        72        |      128       |       1024       |        10        |     2     |   96-111    |
| 0x47000000-0x47FFFFFF | BRAM8 |        72        |      128       |       1024       |        10        |     2     |   112-127   |

#### LUTRAM——叶节点和 Next-Hop 节点

|       地址区间        |     说明      | 存储单元数据位宽 | 对齐后数据位宽 | 存储单元地址数量 | 存储单元地址位宽 | LUT 数量 |
| :-------------------: | :-----------: | :--------------: | :------------: | :--------------: | :--------------: | :------: |
| 0x50000000-0x50FFFFFF |    叶节点     |        8         |       8        |       1024       |        10        |   未知   |
| 0x51000000-0x51FFFFFF | Next-Hop 结点 |       136        |      256       |        64        |        6         |   未知   |

#### DMA

##### 控制 MMIO

|    地址    |  位  |   说明   |
| :--------: | :--: | :------: |
| 0x60000000 | [0]  | 是否可读 |
| 0x60000004 | [0]  | 是否可写 |

##### BRAM——共享内存

|       地址区间        |        说明        | 存储单元数据位宽 | 存储单元地址数量 | 存储单元地址位宽 | BRAM 数量 |
| :-------------------: | :----------------: | :--------------: | :--------------: | :--------------: | :-------: |
| 0x61000000-0x610003FF | 读，前四字节为长度 |        32        |       1024       |        10        |     1     |
| 0x62000000-0x620003FF | 写，前四字节为长度 |        32        |       1024       |        10        |     1     |

#### SRAM

|       地址区间        |   说明   |
| :-------------------: | :------: |
| 0x80000000-0x803FFFFF | Base RAM |
| 0x80400000-0x807FFFFF | Ext RAM  |

#### Flash（预留，已禁用）

|       地址区间        |              说明               |
| :-------------------: | :-----------------------------: |
| 0x90000000-0x907FFFFF | BaseRAM与ExtRAM的初始数据的存储 |

#### 路由器其它 MMIO

|       地址区间        |       说明        |
| :-------------------: | :---------------: |
| 0xA0000000-0xA000000F | 路由器端口 0 统计 |
| 0xA0000010-0xA000001F | 路由器端口 1 统计 |
| 0xA0000020-0xA000002F | 路由器端口 2 统计 |
| 0xA0000030-0xA000003F | 路由器端口 3 统计 |
